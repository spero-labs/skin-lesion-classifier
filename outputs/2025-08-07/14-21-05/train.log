[2025-08-07 14:21:05,720][training][INFO] - Configuration:
[2025-08-07 14:21:05,721][training][INFO] - data:
  data_dir: HAM10000
  metadata_path: HAM10000/HAM10000_metadata.csv
  image_size: 224
  batch_size: 4
  num_workers: 0
  val_split: 0.15
  test_split: 0.15
  use_metadata: false
  use_weighted_sampling: true
  seed: 42
model:
  architecture: efficientnet_b0
  pretrained: true
  num_classes: 7
  dropout: 0.3
  use_metadata: false
training:
  epochs: 1
  learning_rate: 0.001
  weight_decay: 0.0001
  optimizer: adamw
  scheduler: cosine
  early_stopping_patience: 10
  gradient_clip_val: 1.0
  loss: focal
experiment:
  name: baseline_efficientnet_b0
  project_name: skin-lesion-classification
  seed: 42
  device: cpu
  use_wandb: false
  checkpoint_dir: checkpoints
inference:
  tta_enabled: true
  tta_transforms: 5
  confidence_threshold: 0.7
  batch_size: 32
advanced:
  use_ensemble: false
  ensemble_models:
  - efficientnet_b0
  - efficientnet_b1
  - resnet50
  ensemble_weights: null
targets:
  min_val_auc: 0.9
  min_val_accuracy: 0.85
  max_inference_time_ms: 100
  max_model_size_mb: 50

[2025-08-07 14:21:05,721][training][INFO] - Setting up data module...
[2025-08-07 14:21:05,735][src.data.dataset][INFO] - Data splits - Train: 7009, Val: 1503, Test: 1503
[2025-08-07 14:21:05,745][src.data.dataset][INFO] - Class mapping: {'akiec': 0, 'bcc': 1, 'bkl': 2, 'df': 3, 'mel': 4, 'nv': 5, 'vasc': 6}
[2025-08-07 14:21:05,892][src.data.dataset][INFO] - Loaded 7009 images for train set
[2025-08-07 14:21:05,892][src.data.dataset][INFO] - Class distribution: {'nv': 4693, 'mel': 779, 'bkl': 769, 'bcc': 360, 'akiec': 229, 'vasc': 99, 'df': 80}
[2025-08-07 14:21:05,930][src.data.dataset][INFO] - Loaded 1503 images for val set
[2025-08-07 14:21:05,930][src.data.dataset][INFO] - Class distribution: {'nv': 1006, 'mel': 167, 'bkl': 165, 'bcc': 77, 'akiec': 49, 'vasc': 21, 'df': 18}
[2025-08-07 14:21:05,968][src.data.dataset][INFO] - Loaded 1503 images for test set
[2025-08-07 14:21:05,968][src.data.dataset][INFO] - Class distribution: {'nv': 1006, 'mel': 167, 'bkl': 165, 'bcc': 77, 'akiec': 49, 'vasc': 22, 'df': 17}
[2025-08-07 14:21:05,968][src.data.dataloader][INFO] - Dataset setup complete. Classes: 7
[2025-08-07 14:21:05,968][training][INFO] - Creating model: efficientnet_b0
[2025-08-07 14:21:06,015][timm.models._builder][INFO] - Loading pretrained weights from Hugging Face hub (timm/efficientnet_b0.ra_in1k)
[2025-08-07 14:21:08,013][timm.models._hub][INFO] - [timm/efficientnet_b0.ra_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
[2025-08-07 14:21:08,044][src.models.model_factory][INFO] - Created efficientnet_b0 model with 7 classes
[2025-08-07 14:21:08,045][src.models.model_factory][INFO] - Model parameters: 5,618,564
[2025-08-07 14:21:08,046][src.models.model_factory][INFO] - Trainable parameters: 5,618,564
[2025-08-07 14:21:08,051][training][INFO] - Starting training...
[2025-08-07 14:21:08,157][src.training.trainer][INFO] - Starting training...
[2025-08-07 14:21:08,157][src.training.trainer][INFO] - Device: cpu
[2025-08-07 14:21:08,158][src.training.trainer][INFO] - Model parameters: 5,618,564
[2025-08-07 14:21:08,158][src.training.trainer][INFO] - 
==================================================
[2025-08-07 14:21:08,158][src.training.trainer][INFO] - Epoch 1/1
